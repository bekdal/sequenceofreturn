<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sequencing Risk Calculator</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM (Core Libraries) - Pinned versions for stability -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- Prop-types (Often required by Recharts UMD builds) -->
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>

    <!-- Recharts (Charting Library) - Pinned version to avoid 'latest' breakages -->
    <script src="https://cdn.jsdelivr.net/npm/recharts@2.12.7/umd/Recharts.min.js"></script>
    
    <!-- Babel (Compiles JSX in the browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            background-color: #f8fafc;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
    // Error Boundary Component
    class ErrorBoundary extends React.Component {
        constructor(props) {
            super(props);
            this.state = { hasError: false, error: null, errorInfo: null };
        }
        
        static getDerivedStateFromError(error) {
            return { hasError: true, error };
        }
        
        componentDidCatch(error, errorInfo) {
            this.setState({ errorInfo });
            console.error('React Error:', error, errorInfo);
        }
        
        render() {
            if (this.state.hasError) {
                return (
                    <div style={{ 
                        padding: '40px', 
                        background: '#fef2f2',
                        border: '1px solid #fecaca',
                        borderRadius: '8px',
                        margin: '20px'
                    }}>
                        <h2 style={{ color: '#dc2626', marginBottom: '16px' }}>⚠️ React Application Error</h2>
                        <div style={{ 
                            background: '#fca5a5', 
                            padding: '12px', 
                            borderRadius: '6px',
                            marginBottom: '16px',
                            fontFamily: 'monospace',
                            fontSize: '14px'
                        }}>
                            <strong>Error:</strong> {this.state.error?.toString()}
                        </div>
                        {this.state.errorInfo && (
                            <details style={{ marginTop: '16px' }}>
                                <summary>Stack Trace</summary>
                                <pre style={{ 
                                    background: '#f1f5f9', 
                                    padding: '12px', 
                                    borderRadius: '6px',
                                    overflow: 'auto',
                                    fontSize: '12px'
                                }}>
                                    {this.state.errorInfo.componentStack}
                                </pre>
                            </details>
                        )}
                        <button 
                            onClick={() => window.location.reload()}
                            style={{
                                marginTop: '16px',
                                padding: '8px 16px',
                                background: '#3b82f6',
                                color: 'white',
                                border: 'none',
                                borderRadius: '6px',
                                cursor: 'pointer'
                            }}
                        >
                            Reload Page
                        </button>
                    </div>
                );
            }
            return this.props.children;
        }
    }

    // Simple Test Component
    function TestApp() {
        const [loaded, setLoaded] = React.useState(false);
        
        React.useEffect(() => {
            console.log('TestApp mounted');
            setLoaded(true);
        }, []);
        
        return (
            <div style={{ padding: '40px' }}>
                <h1 style={{ color: '#1e293b', marginBottom: '20px' }}>✅ React is Working!</h1>
                <div style={{ 
                    background: '#f1f5f9', 
                    padding: '20px', 
                    borderRadius: '8px',
                    marginBottom: '20px'
                }}>
                    <p><strong>Status:</strong> {loaded ? 'Loaded successfully!' : 'Loading...'}</p>
                    <p><strong>React Version:</strong> {React.version}</p>
                    <p><strong>Recharts:</strong> {typeof Recharts !== 'undefined' ? 'Loaded ✓' : 'Not loaded ✗'}</p>
                </div>
                <button 
                    onClick={() => alert('React is working!')}
                    style={{
                        padding: '10px 20px',
                        background: '#10b981',
                        color: 'white',
                        border: 'none',
                        borderRadius: '6px',
                        cursor: 'pointer'
                    }}
                >
                    Test Button (Click me)
                </button>
            </div>
        );
    }

    // Render with Error Boundary
    console.log('Attempting to render React app...');
    try {
        ReactDOM.render(
            <ErrorBoundary>
                <TestApp />
            </ErrorBoundary>,
            document.getElementById('root')
        );
        console.log('Render attempted');
    } catch (error) {
        console.error('Fatal render error:', error);
        document.getElementById('root').innerHTML = `
            <div style="padding: 40px; color: red;">
                <h2>Fatal Error during render</h2>
                <p><strong>${error.message}</strong></p>
                <pre>${error.stack}</pre>
            </div>
        `;
    }
</script>
</body>
</html>